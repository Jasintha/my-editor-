<div class="justify-content-center" style="margin-top: 100px; overflow-x: auto; padding: 0 50px 0 50px">

    <form name="editForm" role="form" novalidate (ngSubmit)="checkPageNameExist()" [formGroup]="editForm">


        <div class="form-group" [hidden]="!editForm.get('id').value">
            <input type="hidden" class="form-control" id="id" name="id" formControlName="id"/>
        </div>

        <div class="row justify-content-center title-temp">
            <div class="col-md-8">
                <h3 *ngIf="formDisable">{{pageTitle}}</h3>
                <mat-form-field *ngIf="!formDisable" [style]="{'width':'100%'}">
                    <mat-label>Page Title</mat-label>
                    <input type="text" formControlName="pagetitle" matInput name="pagetitle" id="field_pagetitle">
                    <mat-error *ngIf="editForm.controls.pagetitle.hasError('required')">This field is required
                    </mat-error>
                </mat-form-field>
            </div>

            <div class="col-md-4">
                <button type="button" mat-mini-fab aria-label="Example icon-button with a heart icon"
                        (click)="enableToEdit()">
                    <mat-icon>edit</mat-icon>
                </button>
            </div>
        </div>
        <div class="row justify-content-center title-temp">
            <div class="col-md-12">
                <ng-container>
                    <mat-form-field style="width: 1000px; height: 100px;" appearance="fill">
                        <mat-label>Description</mat-label>
                        <textarea style="overflow: auto" [readonly]="formDisable" cdkTextareaAutosize formControlName="pageDescription" name="pageDescription" matInput placeholder="This page is about..."></textarea>
                    </mat-form-field>
                </ng-container>
            </div>
        </div>
        <div>

            <div class="row">
                <div class="col-4 temp-image">
                    <div class="ui-panel-content ui-widget-content justify-content-center" style="padding-top: 5px">
                        <img *ngIf="editForm.value.pagetemplate == 'login-page'" class="pageTmpImgInPage"
                             src="../../../../../assets/images/pages/login.jpg"
                             alt="Template" style="width: 100%">
                        <img *ngIf="editForm.value.pagetemplate == 'aio-table'|| editForm.value.pagetemplate =='table-page'"
                             class="pageTmpImgInPage" src="../../../../../assets/images/pages/allinone.jpg"
                             alt="Template" style="width: 100%">
                        <img *ngIf="editForm.value.pagetemplate == 'form-page' || editForm.value.pagetemplate == 'static-page'  || editForm.value.pagetemplate == 'file-upload-page' || editForm.value.pagetemplate == 'form-wizard-page'"
                             class="pageTmpImgInPage" src="../../../../../assets/images/pages/form.jpg"
                             alt="Template" style="width: 100%">
                        <img *ngIf="editForm.value.pagetemplate == 'register-page'"
                             class="pageTmpImgInPage" src="../../../../../assets/images/pages/register.jpg"
                             alt="Template" style="width: 100%">
                        <img *ngIf="editForm.value.pagetemplate == 'aio-grid' || editForm.value.pagetemplate == 'tile-page'"
                             class="pageTmpImgInPage" src="../../../../../assets/images/pages/grid.jpg"
                             alt="Template" style="width: 100%">
                    </div>
                    <div>
                        <div class="row">
                        <div class="form-group" style="padding: 1%; margin-top: 3%">
                            <mat-form-field [style]="{'width':'100%'}">
                                <mat-label>Page Template</mat-label>
                                <mat-select formControlName="pagetemplate" [disabled]="formDisable">
                                    <mat-option *ngFor="let option of pageTemplateItems" [value]="option.value">
                                        {{option.label}}
                                    </mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>

                            <div class="row">
                                <div class="col-12">
                                    <div class="form-group"
                                         *ngIf="editForm.value.pagetemplate !== 'file-upload-page' && editForm.value.pagetemplate !== 'label-page'">


                                                <mat-form-field  [style]="{'width':'100%'}">
                                                    <mat-label>Model</mat-label>
                                                    <mat-select formControlName="selectedAggregate" (selectionChange)="onChangePageModel($event,false)"
                                                                [disabled]="formDisable">
                                                        <mat-option *ngFor="let option of aggregateItems" [value]="option.value">
                                                            {{option.label}}
                                                        </mat-option>
                                                    </mat-select>
                                                </mat-form-field>

                                    </div>
                                    <virtuan-microservice-model [aggregateId]="aggregateId" [projectUid]='projectUid'
                                                                [isCompactView]=true>
                                    </virtuan-microservice-model>
                                </div>
                            </div>
                            <div *ngIf="editForm.value.pagetemplate == 'tile-page'" class="card">
                                <div class="card-body row">
                                    <div class="col-md-8">
                                        <mat-form-field [style]="{'width':'100%'}">
                                            <mat-label>Number of attributes to display</mat-label>
                                            <input type="number" formControlName="tileFieldCount" [readonly]="formDisable" matInput
                                                   name="tileFieldCount" >
                                        </mat-form-field>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div style="padding: 10px 0 15px 0">
                        <div *ngIf="editForm.value.pagetemplate == 'form-wizard-page'" class="form-group" style="padding: 1%; margin-top: 3%">
                            <mat-form-field [style]="{'width':'100%'}">
                                <mat-label>Wizard layout</mat-label>
                                <mat-select formControlName="wizardLayout" [disabled]="formDisable">
                                    <mat-option *ngFor="let option of tabLayouts" [value]="option.value">
                                        {{option.label}}
                                    </mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>
                        <div *ngIf="editForm.value.pagetemplate == 'chart-page'" class="form-group" style="padding: 1%; margin-top: 3%">
                            <mat-form-field [style]="{'width':'100%'}">
                                <mat-label>Chart type</mat-label>
                                <mat-select formControlName="chartType" [disabled]="formDisable">
                                    <mat-option *ngFor="let option of chartTypes" [value]="option.value">
                                        {{option.label}}
                                    </mat-option>
                                </mat-select>
                            </mat-form-field>
                            <mat-form-field *ngIf="editForm.value.chartType == 'BarChart'" [style]="{'width':'100%'}">
                                <mat-label>Chart axis</mat-label>
                                <mat-select formControlName="barChartAxis" [disabled]="formDisable">
                                    <mat-option *ngFor="let option of chartAxis" [value]="option.value">
                                        {{option.label}}
                                    </mat-option>
                                </mat-select>
                            </mat-form-field>
                            <mat-form-field *ngIf="editForm.value.chartType == 'DonutChart'" [style]="{'width':'100%'}">
                                <mat-label>Arc size</mat-label>
                                    <input type="number" formControlName="donutArcsize" [readonly]="formDisable" matInput
                                           name="donutArcsize" >
                            </mat-form-field>
                            <mat-form-field [style]="{'width':'100%'}">
                                <mat-label>Chart height</mat-label>
                                <input type="number" formControlName="chartHeight" [readonly]="formDisable" matInput
                                       name="chartHeight" >
                            </mat-form-field>
                            <ng-container>
                                <label id="example-radio-group-label">Show legend</label>
                                <mat-radio-group aria-labelledby="example-radio-group-label"
                                                 class="ps-5" aria-label="show Legend" formControlName="showLegend">
                                    <mat-radio-button class="pe-3" value="show">Show</mat-radio-button>
                                    <mat-radio-button value="hide">Hide</mat-radio-button>
                                </mat-radio-group>
                            </ng-container>

                        </div>

                    </div>

                </div>
                <div class="col-8 model-type">
                    <div class="row" style="float: right">
                        <div class="col-4" style="margin-right: 10px">
                            <button (click)="createMainMenu()"
                                    mat-raised-button
                                    color="primary"
                                    type="button" [disabled]="formDisable">
                                <mat-icon>add</mat-icon>
                               Side bar
                            </button>
                        </div>
                        <div class="col-4">
                            <button (click)="createPageNavigation()"
                                    color="primary"
                                    mat-raised-button
                                    type="button" [disabled]="formDisable">
                                <mat-icon>add</mat-icon>
                                 Navigation Params
                            </button>
                        </div>
                    </div>

                </div>

                    <ng-container *ngIf="project?.apptypesID === 'task.ui' && editForm.value.pagetemplate">
                        <div class="form-group mt-3 mb-3" style="margin-top: 10px; margin-bottom: 20px">
                            <div class="row">
                                <div class="col-12">
                                    <div *ngIf="project?.apptypesID === 'task.ui'" class="form-group"
                                         style=" padding-top: 5px; ">
                                        <mat-checkbox [disabled]="formDisable" formControlName="search">Search API from
                                            Microservices
                                        </mat-checkbox>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-6">
                                    <div *ngIf="project?.apptypesID === 'task.ui' && editForm.value.search"
                                         class="form-group">
                                        <mat-form-field [style]="{'width':'100%'}">
                                            <mat-label>Microservice</mat-label>
                                            <mat-select formControlName="microservice"
                                                        (selectionChange)="onChangeMicroserviceProject()"
                                                        [disabled]="formDisable">
                                                <mat-option *ngFor="let option of microserviceProjectItems"
                                                            [value]="option.value">
                                                    {{option.label}}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div *ngIf="project?.apptypesID === 'task.ui' && editForm.value.search"
                                         class="form-group col-md-6">
                                        <mat-form-field [style]="{'width':'100%'}">
                                            <mat-label>API</mat-label>
                                            <mat-select formControlName="api"
                                                        (selectionChange)="onChangeMicroserviceAPI()"
                                                        [disabled]="formDisable">
                                                <mat-option *ngFor="let option of apiItems" [value]="option.value">
                                                    {{option.label}}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-10">
                                    <mat-form-field [style]="{'width':'100%'}">
                                        <mat-label>Resource Path</mat-label>
                                        <input type="text" formControlName="resourcePath" matInput name="resourcepath"
                                               id="field_resourcepath" [readonly]="formDisable">
                                        <mat-error *ngIf="editForm.controls.resourcePath.hasError('required')">This field is
                                            required
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                                <div class="col-md-1">
                                    <button (click)="createPageNavigation()"
                                            mat-raised-button
                                            type="button" [disabled]="formDisable">
                                        <mat-icon>save</mat-icon>
                                    </button>
                                </div>
                            </div>
                        </div>


<!--                        <div class="col-md-2">-->
<!--                            <button [disabled]="formDisable" *ngIf="editForm.value.selectedAggregate" mat-raised-button type="button" style="float:left; background-color: #4CAF50; color: white; " (click)="openViewModelChangeDialog()" cdkFocusInitial> Edit View Model</button>-->
<!--                        </div>-->
                        <mat-accordion style="margin-top: 20px; margin-bottom: 20px">
                            <mat-expansion-panel (opened)="modelConfigView = true"
                                                 (closed)="modelConfigView = false">
                                <mat-expansion-panel-header>
                                    <mat-panel-title>
                                        <h5>
                                            <span>Manage page model attributes</span>
                                        </h5>
                                    </mat-panel-title>
                                </mat-expansion-panel-header>
                                <virtuan-view-model-config [projectUid] ='projectUid' [pageId] ='pageId'></virtuan-view-model-config>
                            </mat-expansion-panel>
                        </mat-accordion>
                        <mat-accordion style="margin-top: 20px; margin-bottom: 20px">
                            <mat-expansion-panel (opened)="modelConfigView = true"
                                                 (closed)="modelConfigView = false">
                                <mat-expansion-panel-header>
                                    <mat-panel-title>
                                        <h5>
                                            <span>Manage page access and authorization</span>
                                        </h5>
                                    </mat-panel-title>
                                </mat-expansion-panel-header>
                                <div class="form-group" style=" padding-top: 5px; ">
                                    <mat-checkbox [disabled]="formDisable" formControlName="isSecurePage">Limit page access
                                        to a role
                                    </mat-checkbox>
                                </div>

                                <div class="form-group" *ngIf="editForm.value.isSecurePage">
                                    <mat-form-field [style]="{'width':'100%'}">
                                        <mat-label>Add authorized role</mat-label>
                                        <input type="text" formControlName="authority" [readonly]="formDisable" matInput
                                               name="resourcepath" id="field_authority">
                                    </mat-form-field>
                                </div>
                            </mat-expansion-panel>
                        </mat-accordion>



                        <div class="form-group" *ngIf="editForm.value.pagetemplate === 'tile-page' || editForm.value.pagetemplate === 'aio-grid'">
                            <h6 style="margin-top: 15px">Match attributes for tile fields</h6>
                            <div class="card">
                                <div class="card-body row">
                                    <div class="col-md-3">
                                        <mat-form-field [style]="{'width':'100%'}">
                                            <mat-label>Choose Param Type</mat-label>
                                            <mat-select formControlName="fieldType"
                                                        [disabled]="formDisable">
                                                <mat-option *ngFor="let option of tilePageFields" [value]="option.value">
                                                    {{option.label}}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div>
                                    <div class="col-md-3">
                                        <mat-form-field [style]="{'width':'100%'}">
                                            <mat-label>Choose Model Property</mat-label>
                                            <mat-select formControlName="matchedAttribute"
                                                        [disabled]="formDisable">
                                                <mat-option *ngFor="let option of modelPropertyList"
                                                            [value]="option.value">
                                                    {{option.label}}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div>
                                    <div class="col-md-3">
                                        <button type="button" style="float: right;" mat-raised-button color="primary"
                                                (click)="addTileFieldMapping()" [disabled]="formDisable">
                                            <mat-icon>add</mat-icon>
                                            Add
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div style=" :20px;padding-bottom:20px;">
                                <table mat-table matSort [dataSource]="dataSourceTile"
                                       class="mat-elevation-z8 demo-table">
                                    <!-- Name Column -->
                                    <ng-container matColumnDef="tileField">
                                        <th mat-header-cell *matHeaderCellDef>Field</th>
                                        <td mat-cell *matCellDef="let element">{{element.tileField}}</td>
                                    </ng-container>

                                    <!-- Weight Column -->
                                    <ng-container matColumnDef="attribute">
                                        <th mat-header-cell *matHeaderCellDef>Attribute</th>
                                        <td mat-cell *matCellDef="let element">{{element.attribute}}</td>
                                    </ng-container>

                                    <ng-container matColumnDef="actions">
                                        <th *matHeaderCellDef mat-header-cell mat-sort-header>Action</th>
                                        <td *matCellDef="let row" class="w-10 text-secondary" mat-cell>
                                            <button (click)="deleteParamMapping(row)"
                                                    mat-icon-button
                                                    type="button" [disabled]="formDisable">
                                                <mat-icon>delete</mat-icon>
                                            </button>
                                        </td>
                                    </ng-container>

                                    <tr mat-header-row *matHeaderRowDef="displayedtileParamColumns"></tr>
                                    <tr mat-row *matRowDef="let row; columns: displayedtileParamColumns;"></tr>
                                </table>

                            </div>
                        </div>

                        <div class="wiz-step" *ngIf="editForm.value.pagetemplate === 'form-wizard-page'"
                             formArrayName="wizardDetailsGroup">
                            <div class="row">
                                <div class="col-md-7">
                                    <h6>Add wizard page steps</h6>
                                </div>
                                <div class="col-md-5" style='text-align: right'>
                                    <button type="button" style="float: right;" mat-raised-button color="primary"
                                            (click)="insertWizardDetailsGroup('')" [disabled]="formDisable">
                                        <mat-icon>add</mat-icon>
                                        Add More
                                    </button>
                                </div>
                            </div>
                            <div style="padding-top: 10px"
                                 *ngFor="let step of wizardDetailsGroup.controls; let i = index">
                                <div [formGroup]="step">
                                    <label class="form-control-label" for="field_pagetitle">Step Header</label>
                                    <div class="row">
                                        <div class="col-md-10">
                                            <mat-form-field [style]="{'width':'100%'}">
                                                <!--                                                        <mat-label>Add authorized role</mat-label>-->
                                                <input type="text" [readonly]="formDisable"
                                                       formControlName="stepHeading" matInput name="stepHeading">
                                            </mat-form-field>
                                        </div>
                                        <div class="col-md-2">
                                            <span class="flex-auto">
                                                <button type="button" mat-mini-fab
                                                        aria-label="Example icon-button with a heart icon"
                                                        (click)="removeWizardDetailsGroup(i)" [disabled]="formDisable">
                                                    <mat-icon>delete</mat-icon>
                                                </button>
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <ng-container *ngIf="editForm.value.pagetemplate === 'form-wizard-page'">
                            <div class="form-group">
                                <label class="form-control-label">Add form fields to steps</label>
                                <div class="card">
                                    <div class="card-body row">
                                        <div class="col-md-3" style="margin-right: 20px">
                                            <mat-form-field [style]="{'width':'100%'}">
                                                <mat-label>Choose Model Property</mat-label>
                                                <mat-select formControlName="fieldName"
                                                            [disabled]="formDisable">
                                                    <mat-option *ngFor="let option of modelPropertyList"
                                                                [value]="option.value">
                                                        {{option.label}}
                                                    </mat-option>
                                                </mat-select>
                                            </mat-form-field>
                                        </div>
                                        <div class="col-md-3">
                                            <mat-form-field [style]="{'width':'100%'}">
                                                <mat-label>Choose the Step</mat-label>
                                                <mat-select formControlName="stepHeader"
                                                            [disabled]="formDisable">
                                                    <mat-option *ngFor="let option of stepHeadersList"
                                                                [value]="option.value">
                                                        {{option.label}}
                                                    </mat-option>
                                                </mat-select>
                                            </mat-form-field>
                                        </div>
                                        <div class="col-md-3" style='text-align: left'>
                                            <button type="button" color="primary" mat-mini-fab
                                                    aria-label="Example icon-button with a heart icon"
                                                    (click)="saveAllWizardSteps()" [disabled]="formDisable">
                                                <mat-icon>refresh</mat-icon>
                                            </button>
                                        </div>
                                        <div class="col-md-2" style='text-align: right'>
                                            <button type="button" style="float: right;" mat-raised-button
                                                    color="primary"
                                                    (click)="addFieldsToSteps()" [disabled]="formDisable">
                                                <mat-icon>add</mat-icon>
                                                Add
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div style="padding-top:20px;padding-bottom:20px;">
                                    <table mat-table matSort [dataSource]="dataSourceWizard"
                                           class="mat-elevation-z8 demo-table">
                                        <!-- Name Column -->
                                        <ng-container matColumnDef="field">
                                            <th mat-header-cell *matHeaderCellDef>Field</th>
                                            <td mat-cell *matCellDef="let element">{{element.field}}</td>
                                        </ng-container>

                                        <!-- Weight Column -->
                                        <ng-container matColumnDef="stepheader">
                                            <th mat-header-cell *matHeaderCellDef>Step in wizard</th>
                                            <td mat-cell *matCellDef="let element">{{element.stepHeader}}</td>
                                        </ng-container>

                                        <ng-container matColumnDef="actions">
                                            <th *matHeaderCellDef mat-header-cell mat-sort-header>Action</th>
                                            <td *matCellDef="let row" class="w-10 text-secondary" mat-cell>
                                                <button (click)="deleteFieldSteps(row)"
                                                        mat-icon-button
                                                        type="button" [disabled]="formDisable">
                                                    <mat-icon>delete</mat-icon>
                                                </button>
                                            </td>
                                        </ng-container>

                                        <tr mat-header-row *matHeaderRowDef="displayedStepHeaderColumns"></tr>
                                        <tr mat-row *matRowDef="let row; columns: displayedStepHeaderColumns;"></tr>
                                    </table>
                                </div>
                            </div>
                        </ng-container>

                        <ng-container *ngIf="editForm.value.pagetemplate === 'static-page'">
                            <div class="wiz-step" formArrayName="detailsHeaderGroup">
                                <div class="row">
                                    <div class="col-md-7">
                                        <h6>Add details page headers</h6>
                                    </div>
                                    <div class="col-md-5" style='text-align: right'>
                                        <button type="button" style="float: right;" mat-raised-button color="primary"
                                                (click)="insertDetailsHeaderGroup('')" [disabled]="formDisable">
                                            <mat-icon>add</mat-icon>
                                            Add More
                                        </button>
                                    </div>
                                </div>
                                <div style="padding-top: 10px"
                                     *ngFor="let step of detailsHeaderGroup.controls; let i = index">
                                    <div [formGroup]="step">
                                        <label class="form-control-label" for="field_pagetitle">Header</label>
                                        <div class="row">
                                            <div class="col-md-10">
                                                <mat-form-field [style]="{'width':'100%'}">
                                                    <!--                                                        <mat-label>Add authorized role</mat-label>-->
                                                    <input type="text" [readonly]="formDisable"
                                                           formControlName="stepHeading" matInput name="stepHeading">
                                                </mat-form-field>
                                            </div>
                                            <div class="col-md-2">
                                            <span class="flex-auto">
                                                <button type="button" mat-mini-fab
                                                        aria-label="Example icon-button with a heart icon"
                                                        (click)="removeDetailsHeaderGroup(i)" [disabled]="formDisable">
                                                    <mat-icon>delete</mat-icon>
                                                </button>
                                            </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-control-label">Add attribute to headers</label>
                                <div class="card">
                                    <div class="card-body row">
                                        <div class="col-md-3" style="margin-right: 20px">
                                            <mat-form-field [style]="{'width':'100%'}">
                                                <mat-label>Choose Model Property</mat-label>
                                                <mat-select formControlName="attributeName"
                                                            [disabled]="formDisable">
                                                    <mat-option *ngFor="let option of modelPropertyList"
                                                                [value]="option.value">
                                                        {{option.label}}
                                                    </mat-option>
                                                </mat-select>
                                            </mat-form-field>
                                        </div>
                                        <div class="col-md-3">
                                            <mat-form-field [style]="{'width':'100%'}">
                                                <mat-label>Choose the Header</mat-label>
                                                <mat-select formControlName="detailHeader"
                                                            [disabled]="formDisable">
                                                    <mat-option *ngFor="let option of detailsHeadersList"
                                                                [value]="option.value">
                                                        {{option.label}}
                                                    </mat-option>
                                                </mat-select>
                                            </mat-form-field>
                                        </div>
                                        <div class="col-md-3" style='text-align: left'>
                                            <button type="button" color="primary" mat-mini-fab
                                                    aria-label="Example icon-button with a heart icon"
                                                    (click)="getAllDetailsHeaders()" [disabled]="formDisable">
                                                <mat-icon>refresh</mat-icon>
                                            </button>
                                        </div>
                                        <div class="col-md-2" style='text-align: right'>
                                            <button type="button" style="float: right;" mat-raised-button
                                                    color="primary"
                                                    (click)="addFieldsToHeaders()" [disabled]="formDisable">
                                                <mat-icon>add</mat-icon>
                                                Add
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div style="padding-top:20px;padding-bottom:20px;">
                                    <table mat-table matSort [dataSource]="dataSourceDetailsPage"
                                           class="mat-elevation-z8 demo-table">
                                        <!-- Name Column -->
                                        <ng-container matColumnDef="field">
                                            <th mat-header-cell *matHeaderCellDef>Field</th>
                                            <td mat-cell *matCellDef="let element">{{element.field}}</td>
                                        </ng-container>

                                        <!-- Weight Column -->
                                        <ng-container matColumnDef="detailsHeader">
                                            <th mat-header-cell *matHeaderCellDef>Headers</th>
                                            <td mat-cell *matCellDef="let element">{{element.stepHeader}}</td>
                                        </ng-container>

                                        <ng-container matColumnDef="actions">
                                            <th *matHeaderCellDef mat-header-cell mat-sort-header>Action</th>
                                            <td *matCellDef="let row" class="w-10 text-secondary" mat-cell>
                                                <button (click)="deleteFieldHeaders(row)"
                                                        mat-icon-button
                                                        type="button" [disabled]="formDisable">
                                                    <mat-icon>delete</mat-icon>
                                                </button>
                                            </td>
                                        </ng-container>

                                        <tr mat-header-row *matHeaderRowDef="displayedDetailHeaderColumns"></tr>
                                        <tr mat-row *matRowDef="let row; columns: displayedDetailHeaderColumns;"></tr>
                                    </table>

                                </div>
                            </div>
                        </ng-container>

                        <div class="form-group" *ngIf="editForm.value.pagetemplate === 'login-page'">
                            <label class="form-control-label">Match properties for credentials input</label>
                            <div class="card">
                                <div class="card-body row">
                                    <div class="col-md-3">
                                        <mat-form-field [style]="{'width':'100%'}">
                                            <mat-label>Choose Param Type</mat-label>
                                            <mat-select formControlName="inputValType"
                                                        [disabled]="formDisable">
                                                <mat-option *ngFor="let option of loginInputs" [value]="option.value">
                                                    {{option.label}}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div>
                                    <div class="col-md-3">
                                        <mat-form-field [style]="{'width':'100%'}">
                                            <mat-label>Choose Model Property</mat-label>
                                            <mat-select formControlName="matchedProperty"
                                                        [disabled]="formDisable">
                                                <mat-option *ngFor="let option of modelPropertyList"
                                                            [value]="option.value">
                                                    {{option.label}}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </div>
                                    <div class="col-md-3">
                                        <button type="button" style="float: right;" mat-raised-button color="primary"
                                                (click)="addParamMapping()" [disabled]="formDisable">
                                            <mat-icon>add</mat-icon>
                                            Add
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div style=" :20px;padding-bottom:20px;">
                                <table mat-table matSort [dataSource]="dataSourceLogin"
                                       class="mat-elevation-z8 demo-table">
                                    <!-- Name Column -->
                                    <ng-container matColumnDef="input">
                                        <th mat-header-cell *matHeaderCellDef>Input</th>
                                        <td mat-cell *matCellDef="let element">{{element.inputType}}</td>
                                    </ng-container>

                                    <!-- Weight Column -->
                                    <ng-container matColumnDef="param">
                                        <th mat-header-cell *matHeaderCellDef>Param</th>
                                        <td mat-cell *matCellDef="let element">{{element.paramName}}</td>
                                    </ng-container>

                                    <ng-container matColumnDef="actions">
                                        <th *matHeaderCellDef mat-header-cell mat-sort-header>Action</th>
                                        <td *matCellDef="let row" class="w-10 text-secondary" mat-cell>
                                            <button (click)="deleteParamMapping(row)"
                                                    mat-icon-button
                                                    type="button" [disabled]="formDisable">
                                                <mat-icon>delete</mat-icon>
                                            </button>
                                        </td>
                                    </ng-container>

                                    <tr mat-header-row *matHeaderRowDef="displayedLoginParamColumns"></tr>
                                    <tr mat-row *matRowDef="let row; columns: displayedLoginParamColumns;"></tr>
                                </table>

                            </div>
                        </div>
                        <ng-container
                                *ngIf="editForm.value.pagetemplate === 'aio-table' || editForm.value.pagetemplate === 'aio-grid'">
                            <div class="card" style="margin-bottom: 20px">
                                <div class="card-body row">
                                    <div class="row col-md-12">
                                        <div style="padding: 10px">
                                            <label class="form-control-label" style="margin-right: 30px">Action pages view type</label>
                                            <mat-radio-group aria-label="Select an option" formControlName="actionPagetype">
                                                <mat-radio-button value="default">Use default views</mat-radio-button>
                                                <mat-radio-button value="navigate" style="margin-left: 5px">Navigate to another page</mat-radio-button>
                                            </mat-radio-group>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="form-control-label">Add API Details</label>
                                <div class="card">
                                    <div class="card-body row">
                                        <div class="row col-md-12">
                                            <div *ngIf="project?.apptypesID === 'task.ui'"
                                                 style=" padding-top: 5px; ">
                                                <mat-checkbox [disabled]="formDisable" formControlName="aiosearch">
                                                    Search API from
                                                    Microservices
                                                </mat-checkbox>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div *ngIf="project?.apptypesID === 'task.ui' && editForm.value.aiosearch"
                                                 class="form-group col-md-6">
                                                <mat-form-field [style]="{'width':'100%'}">
                                                    <mat-label>Microservice</mat-label>
                                                    <mat-select formControlName="aiomicroservice"
                                                                (selectionChange)="onChangeAioTableMicroserviceProject()"
                                                                [disabled]="formDisable">
                                                        <mat-option *ngFor="let option of microserviceProjectItems"
                                                                    [value]="option.value">
                                                            {{option.label}}
                                                        </mat-option>
                                                    </mat-select>
                                                </mat-form-field>
                                            </div>
                                            <div *ngIf="project?.apptypesID === 'task.ui' && editForm.value.aiosearch"
                                                 class="form-group col-md-6">

                                                <mat-form-field [style]="{'width':'100%'}">
                                                    <mat-label>API</mat-label>
                                                    <mat-select formControlName="aiomicroservice"
                                                                (selectionChange)="onChangeAioTableMicroserviceAPI()"
                                                                [disabled]="formDisable">
                                                        <mat-option *ngFor="let option of apiItems"
                                                                    [value]="option.value">
                                                            {{option.label}}
                                                        </mat-option>
                                                    </mat-select>
                                                </mat-form-field>
                                            </div>
                                        </div>
                                        <div class="row col-md-12">
                                            <div class="col-md-4">
                                                <mat-form-field [style]="{'width':'100%'}">
                                                    <mat-label>Choose Operation</mat-label>
                                                    <mat-select  formControlName="apiOperation"
                                                                [disabled]="formDisable">
                                                        <mat-option *ngFor="let option of crudItems"
                                                                    [value]="option.value">
                                                            {{option.label}}
                                                        </mat-option>
                                                    </mat-select>
                                                </mat-form-field>
                                            </div>
                                            <div class="col-md-4">
                                                <mat-form-field [style]="{'width':'100%'}">
                                                    <mat-label>Resource Path</mat-label>
                                                    <input type="text" [readonly]="formDisable"
                                                           formControlName="apiResourcePath" matInput name="name">
                                                </mat-form-field>
                                            </div>
                                            <div class="col-md-4">
                                                <button type="button" style="float: right;" mat-raised-button
                                                        color="primary"
                                                        (click)="addAIOTableRow()" [disabled]="formDisable">
                                                    <mat-icon>add</mat-icon>
                                                    Add
                                                </button>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>

                            <div style="padding-top:20px;padding-bottom:20px;">
                                <table mat-table matSort [dataSource]="dataSourceAIOParam"
                                       class="mat-elevation-z8 demo-table">
                                    <!-- Name Column -->
                                    <ng-container matColumnDef="operation">
                                        <th mat-header-cell *matHeaderCellDef>Operation</th>
                                        <td mat-cell *matCellDef="let element">{{element.apiOperation}}</td>
                                    </ng-container>

                                    <!-- Weight Column -->
                                    <ng-container matColumnDef="path">
                                        <th mat-header-cell *matHeaderCellDef>Resource Path</th>
                                        <td mat-cell *matCellDef="let element">{{element.apiResourcePath}}</td>
                                    </ng-container>

                                    <ng-container matColumnDef="actions">
                                        <th *matHeaderCellDef mat-header-cell mat-sort-header>Remove</th>
                                        <td *matCellDef="let row" class="w-10 text-secondary" mat-cell>
                                            <button (click)="deleteaddAIOTableRow(row)"
                                                    mat-icon-button
                                                    type="button" [disabled]="formDisable">
                                                <mat-icon>delete</mat-icon>
                                            </button>
                                        </td>
                                    </ng-container>

                                    <tr mat-header-row *matHeaderRowDef="displayedAioParamColumns"></tr>
                                    <tr mat-row *matRowDef="let row; columns: displayedAioParamColumns;"></tr>
                                </table>
                            </div>
                        </ng-container>

                    </ng-container>

            </div>
            <div class="card" style="margin-bottom: 20px; margin-top: 20px">
                <div class="card-body row">
                    <div class="row col-md-12">
                        <mat-accordion>
                            <mat-expansion-panel (opened)="actionButtonView = true"
                                                 (closed)="actionButtonView = false">
                                <mat-expansion-panel-header>
                                    <mat-panel-title>
                                        <h5>
                                            <span>Edit form controllers</span>
                                        </h5>
                                    </mat-panel-title>
                                </mat-expansion-panel-header>

<!--                        <div  *ngIf="editForm.value.pagetemplate == 'form-page' || editForm.value.pagetemplate == 'form-wizard-page' || editForm.value.pagetemplate == 'aio-table'  || editForm.value.pagetemplate == 'register-page'" class="col-md-2">-->
<!--                            <button [disabled]="formDisable" *ngIf="editForm.value.selectedAggregate" mat-raised-button type="button" style="float:left; background-color: #4CAF50; color: white; " (click)="openPageControllerConfig()" cdkFocusInitial>Edit Form Controllers</button>-->
<!--                        </div>-->
                                <add-form-controllers [projectUid] ='projectUid' [pageId] ='pageId'></add-form-controllers>
                            </mat-expansion-panel>
                        </mat-accordion>
            <mat-accordion>
            <mat-expansion-panel (opened)="actionButtonView = true"
                                 (closed)="actionButtonView = false">
                <mat-expansion-panel-header>
                    <mat-panel-title>
                        <h5>
                            <span>Add action buttons</span>
                        </h5>
                    </mat-panel-title>
                </mat-expansion-panel-header>
                <ng-container class="flex-auto">
                    <div class="form-group">

                        <div class="card card-body ">
                            <div class="row">
                                <div class="col-md-2">
                                    <mat-form-field class="flex-auto" >
                                        <mat-label>Caption</mat-label>
                                        <input [disabled]="formDisable" type="text" formControlName="btnCaption" matInput>
                                    </mat-form-field>
                                </div>
                                <div class="col-md-2">
                                    <mat-form-field class="flex-auto">
                                        <mat-label>Operation</mat-label>
                                        <mat-select [disabled]="formDisable" formControlName="btnOperation">
                                            <mat-option *ngFor="let option of operationItems" [value]="option.value">
                                                {{option.label}}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                                <div class="col-md-2">
                                    <mat-form-field class="flex-auto" >
                                        <mat-label>Resource path</mat-label>
                                        <input [disabled]="formDisable" type="text" formControlName="btnResourcePath" matInput>
                                    </mat-form-field>
                                </div>
                                <div class="col-md-2" *ngIf="editForm.value.btnOperation == 'NAVIGATE'">
                                    <mat-form-field  class="flex-auto" style="width: 100%">
                                        <mat-label>To Page</mat-label>
                                        <mat-select formControlName="navigatePage">
                                            <mat-option *ngFor="let option of pages" [value]="option.value">
                                                {{option.label}}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                                <div class="col-md-2">
                                    <mat-form-field class="flex-auto">
                                        <mat-label>Confirmation Type</mat-label>
                                        <mat-select [disabled]="formDisable" formControlName="btnConfirmationType">
                                            <mat-option *ngFor="let option of confirmationTypes" [value]="option.value">
                                                {{option.label}}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                                <div class="col-md-2">
                                    <mat-form-field class="flex-auto" >
                                        <mat-label>Color</mat-label>
                                        <input [disabled]="formDisable" type="color" formControlName="btnColor" matInput>
                                    </mat-form-field>
                                </div>
                                <div class="col-md-2">
                                    <mat-form-field class="flex-auto" >
                                        <mat-label>Tooltip</mat-label>
                                        <input [disabled]="formDisable" type="text" formControlName="btnTooltip" matInput>
                                    </mat-form-field>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <button style="float: right;" [disabled]="formDisable" type="button"  mat-raised-button (click)="addRow(false)"><mat-icon>add</mat-icon> ADD</button>
                                </div>
                            </div>
                        </div>
                    </div>

                <div  style="padding-top:20px;padding-bottom:20px;">
                    <table mat-table matSort  [dataSource]="dataSource" class="mat-elevation-z8 demo-table">
                        <!-- Name Column -->
                        <ng-container matColumnDef="caption">
                            <th mat-header-cell *matHeaderCellDef>Caption</th>
                            <td mat-cell *matCellDef="let element">{{element.caption}}</td>
                        </ng-container>

                            <!-- Weight Column -->
                            <ng-container matColumnDef="resourcepath">
                                <th mat-header-cell *matHeaderCellDef>Resource path</th>
                                <td mat-cell *matCellDef="let element">{{element.resourcePath}}</td>
                            </ng-container>
                            <ng-container matColumnDef="operation">
                                <th mat-header-cell *matHeaderCellDef>Operation</th>
                                <td mat-cell *matCellDef="let element">{{element.operation}}</td>
                            </ng-container>
                            <ng-container matColumnDef="page">
                                <th mat-header-cell *matHeaderCellDef>Nav. Page</th>
                                <td mat-cell *matCellDef="let element">{{element.pageName}}</td>
                            </ng-container>

                            <ng-container matColumnDef="color">
                                <th mat-header-cell *matHeaderCellDef>Color</th>
                                <td mat-cell *matCellDef="let element">{{element.color}}</td>
                            </ng-container>
                            <ng-container matColumnDef="tooltip">
                                <th mat-header-cell *matHeaderCellDef>Tooltip</th>
                                <td mat-cell *matCellDef="let element">{{element.tooltip}}</td>
                            </ng-container>
                            <ng-container matColumnDef="actions">
                                <th *matHeaderCellDef mat-header-cell mat-sort-header >Action</th>
                                <td *matCellDef="let row" class="w-10 text-secondary" mat-cell>
                                    <button (click)="deleteRow(row)"
                                            mat-icon-button
                                            type="button">
                                        <mat-icon>delete</mat-icon>
                                    </button>
                                </td>
                            </ng-container>

                            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                        </table>


                    </div>
                </ng-container>
            </mat-expansion-panel>
            </mat-accordion>
            <mat-accordion>
                <mat-expansion-panel (opened)="fieldOrderView = true"
                                     (closed)="fieldOrderView = false">
                    <mat-expansion-panel-header>
                        <mat-panel-title>
                            <h5>
                                <span>Re-Order form fields</span>
                            </h5>
                        </mat-panel-title>
                    </mat-expansion-panel-header>
                    <ng-container *ngIf="currentPage && currentPage.model && currentPage.pagetemplate !== 'chart-page'">

                        <div class="card">
                            <div class="card-body row">
                                <div class="col-md-2">
                                    <mat-form-field class="flex-auto">
                                        <mat-label>Row Id</mat-label>
                                        <mat-select [disabled]="formDisable" formControlName="rowId" (selectionChange)="changeRowHeader()">
                                            <mat-option *ngFor="let option of rowIdList" [value]="option">
                                                {{option}}
                                            </mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                                <div class="col-md-2">
                                    <mat-form-field class="flex-auto" >
                                        <mat-label>Header</mat-label>
                                        <input [disabled]="formDisable" type="text" formControlName="rowHeader" matInput>
                                    </mat-form-field>
                                </div>
                                <button [disabled]="formDisable" (click)="saveRowHeader()"
                                        mat-icon-button
                                        type="button">
                                    <mat-icon>save</mat-icon>
                                </button>

                            </div>
                        </div>

                        <div style="padding-top:20px;padding-bottom:20px;">
                            <table mat-table matSort [dataSource]="fieldDataSourceWizard"
                                   class="mat-elevation-z8 demo-table">

                                <ng-container matColumnDef="field">
                                    <th mat-header-cell *matHeaderCellDef>Field</th>
                                    <td mat-cell *matCellDef="let element">{{element.field}}</td>
                                </ng-container>

                                <ng-container matColumnDef="rowId">
                                    <th mat-header-cell *matHeaderCellDef>Row</th>
                                    <!--                            <td mat-cell *matCellDef="let element">{{element.rowId}}</td>-->
                                    <td *matCellDef="let element; let ind = index" class="w-10 text-secondary" mat-cell>
                                        <mat-form-field>
                                            <mat-select [disabled]="formDisable" [(value)]="element.rowId" (selectionChange)="onRowIdChange(element.rowId, element.field, ind)" >
                                                <mat-option *ngFor="let option of rowIdList" [value]="option">
                                                    {{option}}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </td>
                                    <!--                            <mat-label>Page Template</mat-label>-->

                                </ng-container>

                                <tr mat-header-row *matHeaderRowDef="fieldMapDisplayedColumns"></tr>
                                <tr mat-row *matRowDef="let row; columns: fieldMapDisplayedColumns;"></tr>
                            </table>
                        </div>
                    </ng-container>
                </mat-expansion-panel>
            </mat-accordion>
                        <mat-accordion>
                            <mat-expansion-panel (opened)="actionButtonView = true"
                                                 (closed)="actionButtonView = false">
                                <mat-expansion-panel-header>
                                    <mat-panel-title>
                                        <h5>
                                            <span>Action button event binding</span>
                                        </h5>
                                    </mat-panel-title>
                                </mat-expansion-panel-header>
                                <ng-container class="flex-auto">
                                    <div class="form-group">

                                        <div class="card card-body ">
                                            <div class="row">
                                                <div class="col-md-3">
                                                    <mat-form-field class="flex-auto">
                                                        <mat-label>Action Button</mat-label>
                                                        <mat-select [disabled]="formDisable" formControlName="pageActionButton">
                                                            <mat-option *ngFor="let option of BTN_ELEMENT_DATA" [value]="option">
                                                                {{option.caption}}
                                                            </mat-option>
                                                        </mat-select>
                                                    </mat-form-field>
                                                </div>
                                                <div class="col-md-3">
                                                    <mat-form-field class="flex-auto">
                                                        <mat-label>Event</mat-label>
                                                        <mat-select [disabled]="formDisable" formControlName="pageEvent">
                                                            <mat-option *ngFor="let option of pageEvents" [value]="option.value">
                                                                {{option.label}}
                                                            </mat-option>
                                                        </mat-select>
                                                    </mat-form-field>
                                                </div>
                                                <div class="col-md-3">
                                                    <mat-form-field class="flex-auto">
                                                        <mat-label>Action</mat-label>
                                                        <mat-select [disabled]="formDisable" formControlName="pageEventAction">
                                                            <mat-option *ngFor="let option of pageEventsActions" [value]="option.value">
                                                                {{option.label}}
                                                            </mat-option>
                                                        </mat-select>
                                                    </mat-form-field>
                                                </div>
                                                <div class="col-md-3" *ngIf="editForm.value.pageEventAction == 'CALL_PAGE_ONLOAD'">
                                                    <mat-form-field  class="flex-auto" style="width: 100%">
                                                        <mat-label>Page</mat-label>
                                                        <mat-select formControlName="pageEventActionPage">
                                                            <mat-option *ngFor="let option of pages" [value]="option.value">
                                                                {{option.label}}
                                                            </mat-option>
                                                        </mat-select>
                                                    </mat-form-field>
                                                </div>
                                                <div class="col-md-3" *ngIf="editForm.value.pageEventAction ==  'CALL_API'">
                                                    <mat-label>Resource Path</mat-label>
                                                    <input type="text" [readonly]="formDisable"
                                                           formControlName="pageEventActionApi" matInput name="pageEventActionApi">
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <button style="float: right;" [disabled]="formDisable" type="button"  mat-raised-button (click)="addPageEvent()"><mat-icon>add</mat-icon> ADD</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div  style="padding-top:20px;padding-bottom:20px;">
                                        <table mat-table matSort  [dataSource]="eventDataSource" class="mat-elevation-z8 demo-table">
                                            <!-- Name Column -->
                                            <ng-container matColumnDef="button">
                                                <th mat-header-cell *matHeaderCellDef>Button</th>
                                                <td mat-cell *matCellDef="let element">{{element.btnCaption}}</td>
                                            </ng-container>
                                            <!-- Weight Column -->
                                            <ng-container matColumnDef="event">
                                                <th mat-header-cell *matHeaderCellDef>Event</th>
                                                <td mat-cell *matCellDef="let element">{{element.event}}</td>
                                            </ng-container>
                                            <ng-container matColumnDef="action">
                                                <th mat-header-cell *matHeaderCellDef>Event Action</th>
                                                <td mat-cell *matCellDef="let element">{{element.eventAction}}</td>
                                            </ng-container>
                                            <ng-container matColumnDef="page">
                                                <th mat-header-cell *matHeaderCellDef> Page</th>
                                                <td mat-cell *matCellDef="let element">{{element.pageName}}</td>
                                            </ng-container>
                                            <ng-container matColumnDef="api">
                                                <th mat-header-cell *matHeaderCellDef> API</th>
                                                <td mat-cell *matCellDef="let element">{{element.resourcePath}}</td>
                                            </ng-container>
                                            <ng-container matColumnDef="actions">
                                                <th *matHeaderCellDef mat-header-cell >Remove</th>
                                                <td *matCellDef="let row" class="w-10 text-secondary" mat-cell>
                                                    <button (click)="deleteEventRow(row)"
                                                            mat-icon-button
                                                            type="button">
                                                        <mat-icon>delete</mat-icon>
                                                    </button>
                                                </td>
                                            </ng-container>

                                            <tr mat-header-row *matHeaderRowDef="eventDisplayedColumns"></tr>
                                            <tr mat-row *matRowDef="let row; columns: eventDisplayedColumns;"></tr>
                                        </table>


                                    </div>
                                </ng-container>
                            </mat-expansion-panel>
                        </mat-accordion>
                    </div>
                </div>
            </div>

        </div>
        <div class="form-button-footer" style="padding-top: 25px; float: right">
            <!--                    <button type="button" id="cancel-save" class="btn btn-secondary"  (click)="previousState()" style="margin-right: 8px">-->
            <!--                        <i class="fa fa-chevron-circle-left"></i>&nbsp;<span>Back</span>-->
            <!--                    </button>-->
            <button mat-raised-button color="primary" [disabled]="editForm.invalid || isSaving || formDisable"
                    type="submit" cdkFocusInitial>
                Save
            </button>
        </div>
    </form>

</div>
<ngx-spinner bdColor="rgba(51, 51, 51, 0.8)" size="default" type="ball-spin-clockwise">
    <p style="color: white">Please wait... </p>
</ngx-spinner>


<p-sidebar *ngIf="isSelected" [(visible)]="isSidebarVisible" [style]="{width:'50%',overflow: 'hidden'}" position="right"
           [blockScroll]="true" [showCloseIcon]="false" (onHide)="sidenavClosed()">
    <virtuan-add-new-microservice-aggregate *ngIf="!sidebar" [projectUid]='projectUid' [isVisible]="isSidebarVisible"
                                            [createStatus]="createStatus" (isVisibleEvent)="backSidebar($event)"
                                            (aggregateId)="aggregate($event)"></virtuan-add-new-microservice-aggregate>
</p-sidebar>


